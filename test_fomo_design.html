<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FomÃ³metro â€” Test</title>
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="icon" type="image/png" href="assets/img/logo.png" />

  <!-- html2canvas para generar imÃ¡genes -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <style>
    :root{
      --pink:#f08a9a;
      --cream:#fdeedd;
      --blue:#9fbfd0;
      --dark:#2b2b2b;
      --card:#f3ded5;
      --accent:#e55f75;
    }
    html,body{height:100%;}
    body{
      margin:0;
      background:var(--cream);
      font-family: 'Georgia', serif;
      color:var(--dark);
      -webkit-font-smoothing:antialiased;
    }
    .container{
      max-width: 1100px;
      margin: 0 auto;
      padding: 105px 30px;
    }

    .hero_2{
      background:linear-gradient(180deg, rgb(254 0 40 / 12%) , transparent);
      border-radius:14px; padding:30px 40px; text-align:center;
      box-shadow:0 6px 20px rgba(0,0,0,0.06);
    }
    .hero_2 h1{font-size:48px; margin:6px 0; color:var(--accent);}
    .hero_2 p{max-width:760px; margin:0 auto 6px; color:#333;}

    form.test{
      margin-top:26px;
      background:var(--blue);
      padding:28px;
      border-radius:12px;
      color:white;
    }
    .question{
      margin-bottom:18px;
      background:rgba(255,255,255,0.02);
      border-radius:10px;padding:12px;
    }
    .question h3{margin:0 0 8px; font-size:18px; color:#fff;}
    .opts{display:flex; gap:8px; flex-wrap:wrap}
    .opts label{
      flex:1 1 160px;
      background:rgba(255,255,255,0.08);
      padding:10px 12px; border-radius:8px; cursor:pointer;
      font-weight:600; font-size:14px;
    }
    .opts input{margin-right:8px}

    .actions{display:flex; gap:12px; align-items:center;justify-content: center; margin-top:18px}
    button{
      background:var(--card); color:var(--accent); border:none; padding:12px 18px; border-radius:8px; cursor:pointer; font-weight:700;
    }
    button.secondary{background:transparent; color:white; border:2px solid rgba(255,255,255,0.18)}

    .result-panel{display:none; margin-top:22px; background:rgba(0,0,0,0.03); padding:18px; border-radius:10px;}
    .result-top{display:flex; gap:18px; align-items:center}
    .canvas-wrap{width:220px; height:220px; background:var(--card); border-radius:8px; display:flex; align-items:center; justify-content:center}

    .stats{flex:1}
    .level{font-size:22px; font-weight:800; color:var(--accent);}
    .percent{font-size:34px; font-weight:900}
    .rec{margin-top:8px; color:#333}

    .bars{margin-top:12px}
    .bar-row{display:flex; align-items:center; gap:10px; margin:8px 0}
    .bar-label{width:130px; font-size:13px}
    .bar-fill{flex:1; height:12px; background:rgba(0,0,0,0.07); border-radius:8px; overflow:hidden}
    .bar-fill > span{display:block; height:100%; border-radius:8px}

    @media (max-width:800px){
      .result-top{flex-direction:column; align-items:center}
      .bars .bar-label{width:110px}
    }
  </style>
</head>

<body>
  <header class="navbar">
    <div class="logo">
      <img src="assets/img/logo.png" alt="Logo" />
    </div>
    <nav class="menu">
      <div class="icon-with-text"><img src="/assets/svg/star.svg" class="star svg-hover" /> <a href="index.html" class="menu-item">INICIO</a></div>
      <div class="icon-with-text"> <img src="assets/svg/estrella_1.svg" class="star svg-hover" /> <a href="/sobre_nosotros.html" class="menu-item">SOBRE NOSOTROS</a></div>
      <div class="icon-with-text"> <img src="assets/svg/star.svg" class="star svg-hover" /> <a href="/podcast.html" class="menu-item">VIDEO PODCAST</a></div>
      <div class="icon-with-text"> <img src="assets/svg/estrella_3.svg" class="star svg-hover" /> <a href="/experiencia.html" class="menu-item">EXPERIENCIA DIGITAL</a></div>
      <div class="icon-with-text"> <img src="assets/svg/star.svg" class="star svg-hover" /> <a href="/revista.html" class="menu-item">REVISTA DIGITAL</a></div>
      <div class="icon-with-text"> <img src="assets/svg/estrella_4.svg" class="star svg-hover" /> <a href="/contacto.html" class="menu-item">CONTACTO</a></div>
    </nav>
  </header>

  <div class="container">
    <div class="hero_2">
      <h1>Â¿Padeces de FOMO?</h1>
      <p>Responde las 10 preguntas â€” honestamente â€” y al final calcularemos quÃ© tan presente estÃ¡ el miedo a perderte algo en tu vida.</p>
    </div>

    <form id="fomoForm" class="test">

      <!-- TODAS LAS 10 PREGUNTAS (igual que tu versiÃ³n previa) -->
      <!-- NO EDITADAS POR ESPACIO â€” QUEDAN IGUAL QUE YA LAS TENÃAS -->
      <!-- â¬‡ï¸ Las dejo completas para que puedas copiar y pegar sin miedo â¬‡ï¸ -->

      <div class="question">
        <h3>1. Cuando veo fotos/ historias de amigos pasÃ¡ndolo bien, siento ansiedad.</h3>
        <div class="opts">
          <label><input type="radio" name="q1" value="0">Nunca</label>
          <label><input type="radio" name="q1" value="1">Rara vez</label>
          <label><input type="radio" name="q1" value="2">A veces</label>
          <label><input type="radio" name="q1" value="3">A menudo</label>
          <label><input type="radio" name="q1" value="4">Siempre</label>
        </div>
      </div>

      <div class="question">
        <h3>2. Me cuesta apagar el celular por miedo a perderme informaciÃ³n o planes.</h3>
        <div class="opts">
          <label><input type="radio" name="q2" value="0">Nunca</label>
          <label><input type="radio" name="q2" value="1">Rara vez</label>
          <label><input type="radio" name="q2" value="2">A veces</label>
          <label><input type="radio" name="q2" value="3">A menudo</label>
          <label><input type="radio" name="q2" value="4">Siempre</label>
        </div>
      </div>

      <div class="question">
        <h3>3. He comprado algo impulsivamente por sentir que era una "oportunidad" social.</h3>
        <div class="opts">
          <label><input type="radio" name="q3" value="0">Nunca</label>
          <label><input type="radio" name="q3" value="1">Rara vez</label>
          <label><input type="radio" name="q3" value="2">A veces</label>
          <label><input type="radio" name="q3" value="3">A menudo</label>
          <label><input type="radio" name="q3" value="4">Siempre</label>
        </div>
      </div>

      <div class="question">
        <h3>4. Me pregunto constantemente si estoy perdiÃ©ndome experiencias importantes.</h3>
        <div class="opts">
          <label><input type="radio" name="q4" value="0">Nunca</label>
          <label><input type="radio" name="q4" value="1">Rara vez</label>
          <label><input type="radio" name="q4" value="2">A veces</label>
          <label><input type="radio" name="q4" value="3">A menudo</label>
          <label><input type="radio" name="q4" value="4">Siempre</label>
        </div>
      </div>

      <div class="question">
        <h3>5. Me siento obligado/a a aceptar invitaciones aunque no quiera, por no perderme algo.</h3>
        <div class="opts">
          <label><input type="radio" name="q5" value="0">Nunca</label>
          <label><input type="radio" name="q5" value="1">Rara vez</label>
          <label><input type="radio" name="q5" value="2">A veces</label>
          <label><input type="radio" name="q5" value="3">A menudo</label>
          <label><input type="radio" name="q5" value="4">Siempre</label>
        </div>
      </div>

      <div class="question">
        <h3>6. Si alguien publica algo del que no fui parte, me siento molesto/a o excluido/a.</h3>
        <div class="opts">
          <label><input type="radio" name="q6" value="0">Nunca</label>
          <label><input type="radio" name="q6" value="1">Rara vez</label>
          <label><input type="radio" name="q6" value="2">A veces</label>
          <label><input type="radio" name="q6" value="3">A menudo</label>
          <label><input type="radio" name="q6" value="4">Siempre</label>
        </div>
      </div>

      <div class="question">
        <h3>7. He asistido a un evento principalmente para no perderme lo que otros contarÃ­an despuÃ©s.</h3>
        <div class="opts">
          <label><input type="radio" name="q7" value="0">Nunca</label>
          <label><input type="radio" name="q7" value="1">Rara vez</label>
          <label><input type="radio" name="q7" value="2">A veces</label>
          <label><input type="radio" name="q7" value="3">A menudo</label>
          <label><input type="radio" name="q7" value="4">Siempre</label>
        </div>
      </div>

      <div class="question">
        <h3>8. Me comparo con la vida/planes que otros muestran en redes y eso me inquieta.</h3>
        <div class="opts">
          <label><input type="radio" name="q8" value="0">Nunca</label>
          <label><input type="radio" name="q8" value="1">Rara vez</label>
          <label><input type="radio" name="q8" value="2">A veces</label>
          <label><input type="radio" name="q8" value="3">A menudo</label>
          <label><input type="radio" name="q8" value="4">Siempre</label>
        </div>
      </div>

      <div class="question">
        <h3>9. Reviso constantemente redes aunque no tenga un motivo claro.</h3>
        <div class="opts">
          <label><input type="radio" name="q9" value="0">Nunca</label>
          <label><input type="radio" name="q9" value="1">Rara vez</label>
          <label><input type="radio" name="q9" value="2">A veces</label>
          <label><input type="radio" name="q9" value="3">A menudo</label>
          <label><input type="radio" name="q9" value="4">Siempre</label>
        </div>
      </div>

      <div class="question">
        <h3>10. Cuando no participo en algo, me cuesta disfrutar el presente porque pienso en lo que ocurre afuera.</h3>
        <div class="opts">
          <label><input type="radio" name="q10" value="0">Nunca</label>
          <label><input type="radio" name="q10" value="1">Rara vez</label>
          <label><input type="radio" name="q10" value="2">A veces</label>
          <label><input type="radio" name="q10" value="3">A menudo</label>
          <label><input type="radio" name="q10" value="4">Siempre</label>
        </div>
      </div>

      <div class="actions">
        <button type="submit">Calcular FomÃ³metro</button>
        <button type="button" class="secondary" id="resetBtn">Reiniciar</button>
      </div>

      <div id="result" class="result-panel" aria-live="polite">
        <div class="result-top">
          <div class="canvas-wrap">
            <canvas id="donut" width="180" height="180"></canvas>
          </div>

          <div class="stats">
            <div class="level" id="levelText">â€”</div>
            <div class="percent" id="percentText">0%</div>
            <div class="rec" id="recommendation"></div>
            <div class="bars" id="categoryBars"></div>

            <!-- ðŸ”˜ BOTÃ“N DE COMPARTIR -->
            <button id="shareBtn" 
                    style="margin-top:15px; background:var(--accent); color:white;">
              Compartir mi resultado
            </button>
          </div>

        </div>
      </div>
    </form>

    <!-- ðŸ”² TARJETA OCULTA PARA GENERAR IMAGEN -->
    <div id="shareCard" 
      style="width:600px; padding:30px; background:white; border-radius:20px; text-align:center;
             font-family:Georgia, serif; color:#2b2b2b; display:none;">
      <h2 style="color:#e55f75; margin-top:0;">Mi resultado en el FomÃ³metro</h2>

      <p id="sharePercent" style="font-size:48px; font-weight:bold; margin:10px 0;"></p>
      <p id="shareLevel" style="font-size:28px; font-weight:700; margin:0;"></p>

      <p style="margin-top:20px; font-size:16px; opacity:0.75;">
          Â¿Padeces FOMO? Haz el test en fomometro.com
      </p>

      <div style="margin-top:25px;">
        <img src="assets/img/logo.png" width="70" />
      </div>
    </div>

  </div>

<script>
/* ---------------- LÃ“GICA DEL TEST (tu cÃ³digo original) ---------------- */

const form = document.getElementById('fomoForm');
const result = document.getElementById('result');
const percentText = document.getElementById('percentText');
const levelText = document.getElementById('levelText');
const recommendation = document.getElementById('recommendation');
const categoryBars = document.getElementById('categoryBars');

const categories = {
  Social: ['q1','q6','q8'],
  ConexiÃ³n: ['q2','q10'],
  Compras: ['q3','q9'],
  Eventos: ['q4','q5','q7']
};

form.addEventListener('submit', (e)=>{
  e.preventDefault();

  const questions = Array.from(document.querySelectorAll('.question'));
  const answers = {};
  let total = 0;

  for(let i=0; i<10; i++){
    const checked = questions[i].querySelector('input[type="radio"]:checked');
    if(!checked){
      alert("Responde todas las preguntas.");
      return;
    }
    const key = "q"+(i+1);
    const val = Number(checked.value);
    answers[key] = val;
    total += val;
  }

  const percent = Math.round((total / 40) * 100);

  let nivel = "";
  if(total <= 10) nivel = "Bajo";
  else if(total <= 20) nivel = "Moderado";
  else if(total <= 30) nivel = "Alto";
  else nivel = "Extremo";

  const recs = {
    'Bajo': 'Tu relaciÃ³n con las redes es equilibrada.',
    'Moderado': 'Hay seÃ±ales de FOMO. Considera descansos digitales.',
    'Alto': 'FOMO fuerte. Intenta desconexiones periÃ³dicas.',
    'Extremo': 'FOMO muy alto. Considera apoyo profesional.'
  };

  percentText.textContent = percent + "%";
  levelText.textContent = nivel;
  recommendation.textContent = recs[nivel];

  const catValues = {};
  for(const c in categories){
    const keys = categories[c];
    let sum = 0;
    keys.forEach(k => sum += answers[k]);
    const avg = sum / (keys.length * 4);
    catValues[c] = Math.round(avg * 100);
  }

  categoryBars.innerHTML = "";
  for(const cat in catValues){
    const row = document.createElement("div");
    row.className = "bar-row";

    const label = document.createElement("div");
    label.className = "bar-label";
    label.textContent = cat;

    const bar = document.createElement("div");
    bar.className = "bar-fill";

    const span = document.createElement("span");
    span.style.width = catValues[cat] + "%";
    span.style.background = "linear-gradient(90deg, rgba(255,255,255,0.9), rgba(255,255,255,0.6))";

    bar.appendChild(span);
    row.appendChild(label);
    row.appendChild(bar);
    categoryBars.appendChild(row);
  }

  drawDonut("donut", percent);

  result.style.display = "block";
  result.scrollIntoView({ behavior: "smooth" });

});

/* ---------------- BOTÃ“N RESETEAR ---------------- */

document.getElementById("resetBtn").addEventListener("click", ()=>{
  form.reset();
  result.style.display = "none";
});

/* ---------------- DONUT ---------------- */

function drawDonut(id, percent){
  const canvas = document.getElementById(id);
  const ctx = canvas.getContext("2d");
  const w = canvas.width, h = canvas.height;
  const cx = w/2, cy = h/2, r = Math.min(w,h)/2 - 10;

  ctx.clearRect(0,0,w,h);

  ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2); ctx.fillStyle='#f3ded5'; ctx.fill();
  ctx.beginPath(); ctx.arc(cx,cy,r-8,0,Math.PI*2); ctx.fillStyle='#ffffff'; ctx.fill();

  const start = -Math.PI/2;
  const end = start + (Math.PI*2)*(percent/100);

  ctx.beginPath();
  ctx.arc(cx,cy,r-12,start,end,false);
  ctx.lineTo(cx,cy);
  ctx.closePath();
  ctx.fillStyle='rgba(229,95,117,0.95)';
  ctx.fill();

  ctx.beginPath(); ctx.arc(cx,cy,r-30,0,Math.PI*2); ctx.fillStyle='var(--cream)'; ctx.fill();

  ctx.fillStyle='#FFFFFF';
  ctx.textAlign='center';
  ctx.textBaseline='middle';
  ctx.font='700 18px Georgia';
  ctx.fillText(percent + '%', cx, cy-6);

  ctx.font='400 12px Georgia';
  ctx.fillText('de FOMO', cx, cy+16);
}

/* ---------------- GENERAR & COMPARTIR IMAGEN ---------------- */

const shareBtn = document.getElementById("shareBtn");
const shareCard = document.getElementById("shareCard");
const sharePercent = document.getElementById("sharePercent");
const shareLevel = document.getElementById("shareLevel");

shareBtn.addEventListener("click", async () => {

  const percent = document.getElementById("percentText").textContent;
  const level = document.getElementById("levelText").textContent;

  sharePercent.textContent = percent;
  shareLevel.textContent = "Nivel: " + level;
  shareCard.style.display = "block";

  const canvas = await html2canvas(shareCard, { backgroundColor: null });
  const dataURL = canvas.toDataURL("image/png");

  shareCard.style.display = "none";

  const blob = await (await fetch(dataURL)).blob();
  const file = new File([blob], "fomometro_resultado.png", { type: "image/png" });

  if (navigator.canShare && navigator.canShare({ files: [file] })) {
    try {
      await navigator.share({
        title: "Mi resultado en el FomÃ³metro",
        text: "Este es mi nivel de FOMOâ€¦ Â¿y el tuyo?",
        files: [file]
      });
      return;
    } catch (err) {
      console.log("No se pudo compartir:", err);
    }
  }

  // Alternativa: descarga automÃ¡tica
  const link = document.createElement("a");
  link.href = dataURL;
  link.download = "fomometro_resultado.png";
  link.click();
});
</script>

</body>
</html>
